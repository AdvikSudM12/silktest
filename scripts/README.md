# Директория скриптов

Эта директория содержит утилиты для работы с файлами и обработки данных.

## Доступные скрипты

### excel_operations.py
Скрипт для работы с Excel файлами, который:
- Переносит строки из одного листа Excel в другой на основе отслеживания ошибок
- Читает данные об ошибках из файла результатов сравнения
- Перемещает соответствующие строки в специальный лист ошибок
- Обновляет исходный лист, удаляя перенесенные строки

### compare_files.py
Скрипт для сравнения файлов и отслеживания различий:
- Сравнивает файлы между директориями
- Генерирует результаты сравнения в формате Excel
- Отслеживает расхождения и ошибки в файлах

## Использование

### Операции с Excel
```bash
python3 excel_operations.py
```
Этот скрипт:
1. Читает файл отслеживания ошибок
2. Находит соответствующие треки в основном Excel файле
3. Переносит треки с ошибками в специальный лист
4. Удаляет перенесенные треки из исходного листа

### Сравнение файлов
```bash
python3 compare_files.py
```
Этот скрипт:
1. Сравнивает файлы между указанными директориями
2. Создает подробный отчет о различиях
3. Сохраняет результаты в формате Excel

## Зависимости
- Python 3.x
- pandas
- openpyxl

## Пути к файлам
Скрипты используют следующие пути к файлам:
- Основной Excel файл: `/src/apps/release-parser-5/files/releases.xlsx`
- Файл отслеживания ошибок: `/results/file_comparison_results_[ДАТА].xlsx`

## Результаты
- Результаты сохраняются в исходном Excel файле
- Перенесенные строки перемещаются в лист 'Ошибки_загрузки_05.02.25'
- Исходный лист 'Лист1' обновляется с удаленными строками

# Скрипт сравнения файлов

Этот скрипт сравнивает названия файлов из Excel файла с реальными файлами в папке и создает отчет о различиях.

## Установка

1. Убедитесь, что у вас установлен Python 3.7 или выше
2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

1. Поместите ваш Excel файл в удобное место
2. Запустите скрипт:
```bash
python compare_files.py
```
3. Введите полный путь к вашему Excel файлу когда будет запрошено

## Требования к Excel файлу

Excel файл должен содержать следующие столбцы в 'Лист1':
- `track (titel)` - названия треков
- `cover (titel)` - названия обложек

## Результаты

- Результаты сравнения будут сохранены в файл `results/file_comparison_results.xlsx`
- В файле будут следующие колонки для треков и обложек:
  - Название в Excel
  - Найден в папке (Да/Нет)
  - Ближайшее совпадение (если файл не найден)
  - Процент сходства
  - Различия (точные позиции различающихся символов)

## Статистика

После завершения работы скрипт выводит статистику:
- Общее количество записей
- Количество отсутствующих треков
- Количество отсутствующих обложек

## Примечания

- Скрипт ищет файлы в папке `src/apps/release-parser-5/files`
- Скрипт читает только 'Лист1' из Excel файла
- Требуются столбцы 'track (titel)' и 'cover (titel)' в Excel файле
